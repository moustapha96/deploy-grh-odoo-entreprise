import{j as e,c as N,T as v,E as C,F as j,G as f,H as S,S as E,I as k,u as D,J as R,K as A,M as L,N as P}from"./index-VSx_m0AV.js";import{r as l}from"./vendor-DvxF9bYu.js";function M({orders:r=[]}){const[s,t]=l.useState(1),n=5,i=s*n,c=i-n,x=r.slice(c,i),d=a=>{switch(a.toLowerCase()){case"sale":return"Confirmé";case"cancel":return"Annulé";case"draft":return"Brouillon";default:return"En cours"}},u=a=>{switch(a.toLowerCase()){case"sale":return e.jsx(f,{className:"w-4 h-4 text-green-500"});case"cancel":return e.jsx(j,{className:"w-4 h-4 text-red-500"});case"draft":return e.jsx(C,{className:"w-4 h-4 text-yellow-500"});default:return e.jsx(v,{className:"w-4 h-4 text-blue-500"})}},h=a=>{switch(a.toLowerCase()){case"sale":return"text-green-500 bg-green-100";case"cancel":return"text-red-500 bg-red-100";case"draft":return"text-yellow-500 bg-yellow-100";default:return"text-blue-500 bg-blue-100"}};return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-gray-200 px-4 py-3",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Commandes Récentes"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montant"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:a.name}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:a.partner_name}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:new Date(a.date_order).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[a.amount_total.toLocaleString()," FCFA"]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("span",{className:N("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",h(a.state)),children:[u(a.state),e.jsx("span",{className:"ml-1 capitalize",children:d(a.state)})]})})]},a.id))})]})}),r.length>n&&e.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>t(s-1),disabled:s===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Précédent"}),e.jsx("button",{onClick:()=>t(s+1),disabled:s===Math.ceil(r.length/n),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Suivant"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Affichage de ",e.jsx("span",{className:"font-medium",children:c+1})," à"," ",e.jsx("span",{className:"font-medium",children:Math.min(i,r.length)})," sur"," ",e.jsx("span",{className:"font-medium",children:r.length})," résultats"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>t(s-1),disabled:s===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[e.jsx("span",{className:"sr-only",children:"Précédent"}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),e.jsxs("button",{onClick:()=>t(s+1),disabled:s===Math.ceil(r.length/n),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[e.jsx("span",{className:"sr-only",children:"Suivant"}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]})]})}const m=({title:r,count:s,icon:t,color:n})=>e.jsx("div",{className:"rounded-md border border-default-200 bg-white dark:bg-default-50",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-default-600",children:r}),e.jsxs("span",{className:`text-${n}-500`,children:[e.jsx(k,{className:"me-1 inline size-4"}),s]})]}),e.jsxs("div",{className:"flex items-end justify-between gap-4",children:[e.jsx("h3",{className:"text-3xl font-medium text-default-800",children:s}),e.jsx(t,{size:70,className:`text-${n}-500`})]})]})})}),T=({commandesApprouvees:r,commandesEnCours:s,commandesRejetees:t,totalCommandes:n})=>e.jsxs("div",{className:"grid gap-6 lg:grid-cols-4",children:[e.jsx(m,{title:"Commandes approuvées",count:r,icon:f,color:"green"}),e.jsx(m,{title:"Commandes en cours",count:s,icon:S,color:"yellow"}),e.jsx(m,{title:"Commandes rejetées",count:t,icon:j,color:"red"}),e.jsx(m,{title:"Total des commandes",count:n,icon:E,color:"blue"})]}),F=()=>{const{isAuthenticated:r,userInfo:s,parent:t}=D();console.log(s,r);const[n,i]=l.useState([]),[c,x]=l.useState([]),[d,u]=l.useState([]),[h,a]=l.useState(!0),[p,y]=l.useState(null);if(console.log(t),console.log("parent"),l.useEffect(()=>{t&&(async()=>{try{const[o,b,w]=await Promise.all([A(t.id),L(t.id),P(t.id)]);i(o),console.log(o+"approuve"),x(b),u(w)}catch(o){y(o.message)}finally{a(!1)}})()},[t]),h)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:"Chargement du tableau de bord..."});if(p)return e.jsxs("div",{className:"flex justify-center items-center h-screen text-red-600",children:["Erreur: ",p]});const g=n.length+c.length+d.length;return console.log(g),e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Tableau de bord",SubTitle:t?t.entreprise_code:""}),e.jsx("section",{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"my-6 space-y-6",children:[e.jsx(T,{commandesApprouvees:n.length,commandesEnCours:c.length,commandesRejetees:d.length,totalCommandes:g}),e.jsx("div",{className:"grid grid-cols-1",children:e.jsx(M,{orders:[...n,...c,...d]})})]})})})]})};export{F as default};
