import{O as w,m as v,n,j as e,P as N,R as z,U as i}from"./index-BxKYFLTH.js";import{r as m,h as S,L as C}from"./vendor-DvxF9bYu.js";import{o as E}from"./yup-CBYd5xIv.js";import{u as k}from"./resolvers-feI25x5d.js";import{T as b}from"./TextFormInput-rSdzx92w.js";const F=()=>{const{urlApi:c}=m.useContext(w),d=S(),[l,s]=m.useState(!1),[r,u]=m.useState("email"),x=v({email:n().email("Veuillez entrer un email valide").required("Veuillez entrer votre email"),phone:n().when("method",{is:"sms",then:()=>n().required("Veuillez entrer votre numéro de téléphone"),otherwise:()=>n()})}),{control:p,handleSubmit:f,reset:h}=k({resolver:E(x),defaultValues:{email:"",phone:""},context:{method:r}}),y=async a=>{s(!0);try{const t=await(await fetch(`${c}api/reset-password-email/${a.email}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if(t.success){s(!1),i.success(t.message||"Un lien de réinitialisation a été envoyé à votre adresse email."),h(),d("/auth/sign-in");return}s(!1),i.error(t.message||"Impossible d'envoyer le lien de réinitialisation. Veuillez réessayer.")}catch(o){console.error(o),s(!1),i.error("Une erreur est survenue. Veuillez réessayer.")}},g=async a=>{s(!0);try{const t=await(await fetch(`${c}api/reset-password-sms/${a.phone}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if(t.success){s(!1),i.success(t.message||"Un code de réinitialisation a été envoyé à votre numéro de téléphone."),h(),d("/auth/sign-in");return}s(!1),i.error(t.message||"Impossible d'envoyer le code de réinitialisation. Veuillez réessayer.")}catch(o){console.error(o),s(!1),i.error("Une erreur est survenue. Veuillez réessayer.")}},j=a=>{r==="email"?y(a):g(a)};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Mot de passe oublié"}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Mot de passe oublié"}),e.jsx("p",{className:"mt-2 text-zinc-300",children:"Veuillez choisir une méthode pour réinitialiser votre mot de passe."})]}),e.jsxs("div",{className:"flex space-x-2 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>u("email"),className:`flex-1 py-2 rounded-md ${r==="email"?"bg-primary text-white":"bg-transparent border border-white/20 text-white/80"}`,children:"Email"}),e.jsx("button",{type:"button",onClick:()=>u("sms"),className:`flex-1 py-2 rounded-md ${r==="sms"?"bg-primary text-white":"bg-transparent border border-white/20 text-white/80"}`,children:"SMS"})]}),e.jsxs("form",{onSubmit:f(j),className:"mt-6 shrink",children:[r==="email"?e.jsx(b,{containerClassName:"mb-4",label:"Adresse email",name:"email",labelClassName:"block text-base/normal text-zinc-200 font-semibold",className:"block rounded border-white/10 bg-transparent py-2.5 text-white/80 focus:border-white/25 focus:outline-0 focus:ring-0",placeholder:"Entrez votre email",fullWidth:!0,control:p}):e.jsx(b,{containerClassName:"mb-4",label:"Numéro de téléphone",name:"phone",labelClassName:"block text-base/normal text-zinc-200 font-semibold",className:"block rounded border-white/10 bg-transparent py-2.5 text-white/80 focus:border-white/25 focus:outline-0 focus:ring-0",placeholder:"Entrez votre numéro de téléphone",fullWidth:!0,control:p}),e.jsx("div",{className:"mb-6 flex flex-col justify-center gap-4",children:e.jsxs("button",{type:"submit",disabled:l,className:"relative inline-flex w-full items-center justify-center rounded bg-primary px-6 py-3 text-base capitalize text-white transition-all hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[l?"Chargement...":r==="email"?"Envoyer le lien de réinitialisation":"Envoyer le code par SMS",l&&e.jsx(z,{className:"ml-2 animate-spin"})]})})]}),e.jsxs("p",{className:"shrink text-center text-zinc-200",children:["Retour à la",e.jsx(C,{to:"/auth/sign-in",className:"ms-1 text-primary",children:e.jsx("b",{children:"Connexion"})})]})]})};export{F as default};
